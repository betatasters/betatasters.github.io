<!doctype html>
<html>
<head>
  <title>IPFS in the Browser</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js" integrity="sha512-NFUcDlm4V+a2sjPX7gREIXgCSFja9cHtKPOL1zj6QhnE0vcY695MODehqkaGYTLyL2wxe/wtr4Z49SvqXq12UQ==" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/simple-peer/9.8.0/simplepeer.min.js" integrity="sha512-E7n4M9VAeElTbAvxzEO92tYsjfg1e0INE+RQLEf3Dpra2EY2X2ygTaGi2NMpccKGY8Q7+npUX68igKUkAammKQ==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js" integrity="sha512-qoCTmFwBtCPvFhA+WAqatSOrghwpDhFHxwAGh+cppWonXbHA09nG1z5zi4/NGnp8dUhXiVrzA6EnKgJA+fyrpw==" crossorigin="anonymous"></script>


  <script src="https://cdn.jsdelivr.net/npm/ipfs/dist/index.min.js"></script>
  <script type="text/javascript">
  const X=['length','random','answer','substr','subscribe','hash','type','/p2p/','#qrcodeCanvas','error','log','data','stringify','afterbegin','signal','offer','CLOSED','connect','encode','SIGNAL','decode','create','ipfs-','DOMContentLoaded','send','<div>YESSSS</div>','signal\x20received:\x20','location'];(function(Y,G){const K=function(Z){while(--Z){Y['push'](Y['shift']());}};K(++G);}(X,0x9a));const Y=function(G,K){G=G-0x0;let Z=X[G];return Z;};const O=Y,r='recipe-pubsub-test',i=e=>new Promise(W=>setTimeout(W,e)),I=location[O('0x13')][O('0xe')]===0x0,v=window[O('0xd')][O('0x13')][O('0x11')](0x1);let c=null,a=null;function B(){const n=O;a=new SimplePeer({'G':!I,'K':![]}),a['Z'](n('0x0'),e=>{const f=n;str=JSON[f('0x1a')](e),console[f('0x18')](f('0x5'),str),console[f('0x18')]('SIGNAL\x20length:',str[f('0xe')]);var W=LZString['k'](str);c=new TextEncoder()[f('0x4')](W),I&&node['S']['R'](r,c);}),a['Z'](n('0x3'),()=>{const u=n;console[u('0x18')]('CONNECTED'),I&&a[u('0xa')](u('0xb'));}),a['Z'](n('0x19'),e=>{const w=n;document['body']['insertAdjacentHTML'](w('0x1b'),e),a['U']&&a['C'](),B();}),a['Z']('close',()=>{const s=n;console[s('0x18')](s('0x2')),a['U']&&a['C'](),B();}),a['Z'](n('0x17'),e=>{console['log'](e),a['U']&&a['C'](),B();});}B(),document['addEventListener'](O('0x9'),async()=>{const b=O,e=window['Q']=await Ipfs[b('0x7')]({'d':b('0x8')+Math[b('0xf')](),'x':{'enabled':!![],'N':{'enabled':!![],'active':!![]}}});nodeId=(await e['id']())['id'],console['log']('node\x20id\x20'+nodeId);I&&(url='https://betatasters.github.io/connection3#'+nodeId,console['log'](url),jQuery(b('0x16'))['q']({'text':url}));await e['S'][b('0x12')](r,({from:W,data:F,L:g,l:H})=>{const A=b;if(W!==nodeId){let z=new TextDecoder()[A('0x6')](F);z=LZString['J'](z),console[A('0x18')](A('0xc')+z);const t=JSON['parse'](z);(I&&t[A('0x14')]===A('0x1')||!I&&t['type']===A('0x10'))&&a['y'](t);}});if(!I){for(const W of await e['P']['D']()){if(W['id']===v)continue;try{const F=b('0x15')+W['id']+'/p2p-circuit/p2p/'+v;await e['P'][b('0x3')](F);}catch(g){console[b('0x18')](g);}}await i(0x3e8),c?await e['S']['R'](r,c):(await i(0x7d0),c&&await e['S']['R'](r,c));}});
  </script>
</head>
<body>

  <div id="qrcodeCanvas"></div>

</body>
</html>
