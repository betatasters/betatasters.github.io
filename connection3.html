<!--
To use:
Open in two tabs:
file:///Users/bri/Desktop/main2.html#Qmau6v6iBDXTTh3MZDTxXZuGzHDnfw9DDTdYVbVZRd2Js9+123
file:///Users/bri/Desktop/main2.html#{IPFS_ID}+{TAB_ID}
 -->

<!doctype html>
<html>
<head>
  <title>IPFS in the Browser</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="-1">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.qrcode/1.0/jquery.qrcode.min.js" integrity="sha512-NFUcDlm4V+a2sjPX7gREIXgCSFja9cHtKPOL1zj6QhnE0vcY695MODehqkaGYTLyL2wxe/wtr4Z49SvqXq12UQ==" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/simple-peer/9.8.0/simplepeer.min.js" integrity="sha512-E7n4M9VAeElTbAvxzEO92tYsjfg1e0INE+RQLEf3Dpra2EY2X2ygTaGi2NMpccKGY8Q7+npUX68igKUkAammKQ==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js" integrity="sha512-qoCTmFwBtCPvFhA+WAqatSOrghwpDhFHxwAGh+cppWonXbHA09nG1z5zi4/NGnp8dUhXiVrzA6EnKgJA+fyrpw==" crossorigin="anonymous"></script>


  <script src="https://cdn.jsdelivr.net/npm/ipfs/dist/index.min.js"></script>
  <script type="text/javascript">
  const _0x5ccd=['addrs','publish','<div\x20id=\x27qrcodeCanvas\x27></div>','encode','came\x20offline','p2p\x20compressed\x20data\x20size:\x20','location','length','#qrcodeCanvas','data','parse','<div><h1>YAYYYY</h1>YESSSS<h2>Tab\x20id\x20','subscribe','create','<div\x20id=\x27loading\x27>Loading\x20Recipe<div\x20class=\x27loader\x27></div><div>Connecting\x20to\x20IPFS\x20Nodes:</div></div>','decompressFromUTF16','online','innerHTML','readable','createElement','offer','error','offline','qrcode','</h2></div>','style','/p2p-circuit/p2p/','decompressFromUint8Array','node\x20id\x20','ipfs-','addEventListener','loading','_tabid','getElementById','stringify','signal\x20received:\x20','signal','compressToUTF16','body','node','/p2p/','type','random','padding-left:\x2010px;','substr','log','hash','compressToUint8Array','topic\x20is\x20','close','answer','p2p\x20data\x20size:\x20','DOMContentLoaded','Received\x20array\x20length:\x20','came\x20online','swarm','appendChild','pubsub','decode','SIGNAL\x20length:','connect'];(function(_0x171bee,_0x5ccdf1){const _0x1084d4=function(_0x2b8102){while(--_0x2b8102){_0x171bee['push'](_0x171bee['shift']());}};_0x1084d4(++_0x5ccdf1);}(_0x5ccd,0x118));const _0x1084=function(_0x171bee,_0x5ccdf1){_0x171bee=_0x171bee-0x0;let _0x1084d4=_0x5ccd[_0x171bee];return _0x1084d4;};const _0x11c0b3=_0x1084;let topic='recipe-pubsub-test';const delay=_0x2b8102=>new Promise(_0x1bb305=>setTimeout(_0x1bb305,_0x2b8102)),isMain=location[_0x11c0b3('0xa')][_0x11c0b3('0x20')]===0x0,hash=window[_0x11c0b3('0x1f')][_0x11c0b3('0xa')][_0x11c0b3('0x8')](0x1),hashArray=hash['split']('+'),mainsId=hashArray[0x0];let tabId=hashArray[0x1]?hashArray[0x1]:'';!isMain&&(topic=topic+mainsId,console[_0x11c0b3('0x9')](_0x11c0b3('0xc')+topic));let p2pSignal=null,p=null;function setupP2P(){const _0xccf9b2=_0x11c0b3;p=new SimplePeer({'initiator':!isMain,'trickle':![]}),p['on'](_0xccf9b2('0x0'),_0x1765c7=>{const _0x591dac=_0xccf9b2;let _0x230ff0={..._0x1765c7};!isMain&&tabId&&(_0x230ff0['tabid']=tabId);str=JSON[_0x591dac('0x3b')](_0x230ff0),console[_0x591dac('0x9')]('SIGNAL',str),console[_0x591dac('0x9')](_0x591dac('0x17'),str['length']);var _0x439661=LZString[_0x591dac('0x1')](str);p2pSignal=new TextEncoder()[_0x591dac('0x1c')](_0x439661),isMain&&(console[_0x591dac('0x9')](_0x591dac('0xc')+topic),node[_0x591dac('0x15')][_0x591dac('0x1a')](topic,p2pSignal));}),p['on'](_0xccf9b2('0x18'),()=>{const _0x3085b4=_0xccf9b2;console[_0x3085b4('0x9')]('CONNECTED');if(isMain){let _0x1b89ae=_0x3085b4('0x24')+tabId+_0x3085b4('0x31');var _0x504545=LZString[_0x3085b4('0xb')](_0x1b89ae);console[_0x3085b4('0x9')](_0x3085b4('0xf')+_0x1b89ae[_0x3085b4('0x20')]),console['log'](_0x3085b4('0x1e')+_0x504545[_0x3085b4('0x20')]),p['send'](_0x504545);}}),p['on'](_0xccf9b2('0x22'),_0x138051=>{const _0x4d8acd=_0xccf9b2;!isMain&&(console[_0x4d8acd('0x9')](_0x4d8acd('0x11')+_0x138051[_0x4d8acd('0x20')]),document[_0x4d8acd('0x2')][_0x4d8acd('0x2a')]=LZString[_0x4d8acd('0x34')](_0x138051)),p[_0x4d8acd('0x2b')]&&p['destroy'](),isMain&&setupP2P();}),p['on'](_0xccf9b2('0xd'),()=>{const _0x15bbab=_0xccf9b2;console[_0x15bbab('0x9')]('CLOSED'),p['readable']&&p['destroy'](),isMain&&setupP2P();}),p['on'](_0xccf9b2('0x2e'),_0x1f77c4=>{const _0x59d7ec=_0xccf9b2;console['log'](_0x1f77c4),p[_0x59d7ec('0x2b')]&&p['destroy'](),isMain&&setupP2P();});}setupP2P(),window[_0x11c0b3('0x37')](_0x11c0b3('0x29'),()=>console['log'](_0x11c0b3('0x12'))),window[_0x11c0b3('0x37')](_0x11c0b3('0x2f'),()=>console[_0x11c0b3('0x9')](_0x11c0b3('0x1d'))),document[_0x11c0b3('0x37')](_0x11c0b3('0x10'),async()=>{const _0x33e3ca=_0x11c0b3;isMain?document['body']['innerHTML']=_0x33e3ca('0x1b'):document[_0x33e3ca('0x2')][_0x33e3ca('0x2a')]=_0x33e3ca('0x27');const _0x4f47b5=window[_0x33e3ca('0x3')]=await Ipfs[_0x33e3ca('0x26')]({'repo':_0x33e3ca('0x36')+Math[_0x33e3ca('0x6')](),'relay':{'enabled':!![],'hop':{'enabled':!![],'active':!![]}}});nodeId=(await _0x4f47b5['id']())['id'];isMain&&(topic=topic+nodeId);console[_0x33e3ca('0x9')](_0x33e3ca('0x35')+nodeId);isMain&&(url='https://betatasters.github.io/connection3#'+nodeId,console[_0x33e3ca('0x9')](url),jQuery(_0x33e3ca('0x21'))[_0x33e3ca('0x30')]({'text':url}));await _0x4f47b5[_0x33e3ca('0x15')][_0x33e3ca('0x25')](topic,({from:_0x53d302,data:_0x3bc993,topicIDs:_0x85ad2a,seqno:_0x1df426})=>{const _0xd73077=_0x33e3ca;if(_0x53d302!==nodeId){let _0xc8ba89=new TextDecoder()[_0xd73077('0x16')](_0x3bc993);_0xc8ba89=LZString[_0xd73077('0x28')](_0xc8ba89),console[_0xd73077('0x9')](_0xd73077('0x3c')+_0xc8ba89);const _0x49a75d=JSON[_0xd73077('0x23')](_0xc8ba89);_0x49a75d[_0xd73077('0x39')]&&(tabId=_0x49a75d['_tabid'],delete _0x49a75d[_0xd73077('0x39')]),(isMain&&_0x49a75d[_0xd73077('0x5')]===_0xd73077('0x2d')||!isMain&&_0x49a75d[_0xd73077('0x5')]===_0xd73077('0xe'))&&p[_0xd73077('0x0')](_0x49a75d);}});if(!isMain){for(const _0x4f41da of await _0x4f47b5[_0x33e3ca('0x13')][_0x33e3ca('0x19')]()){if(_0x4f41da['id']===mainsId)continue;try{const _0x560bc1=_0x33e3ca('0x4')+_0x4f41da['id']+_0x33e3ca('0x33')+mainsId;var _0x353b35=document[_0x33e3ca('0x2c')]('div');_0x353b35['innerText']=_0x4f41da['id'],_0x353b35[_0x33e3ca('0x32')]=_0x33e3ca('0x7'),document[_0x33e3ca('0x3a')](_0x33e3ca('0x38'))[_0x33e3ca('0x14')](_0x353b35),await _0x4f47b5['swarm'][_0x33e3ca('0x18')](_0x560bc1);}catch(_0x47df4a){console['log'](_0x47df4a);}}await delay(0x3e8),p2pSignal?await _0x4f47b5[_0x33e3ca('0x15')][_0x33e3ca('0x1a')](topic,p2pSignal):(await delay(0x7d0),p2pSignal&&await _0x4f47b5['pubsub'][_0x33e3ca('0x1a')](topic,p2pSignal));}});
   
   
  </script>

  <style>
  .loader {
    border: 16px solid #f3f3f3; /* Light grey */
    border-top: 16px solid #3498db; /* Blue */
    border-radius: 50%;
    width: 120px;
    height: 120px;
    animation: spin 2s linear infinite;
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  </style>
</head>
<body>





</body>
</html>
